let players = [
    {
        name: "Caleb Williams",
        school: "USC",
        position: "QB",
        id: "player1"
    },
    {
        name: "Drake Maye",
        school: "UNC",
        position: "QB",
        id: "player2"
    },
    {
        name: "Marvin Harrison Jr",
        school: "Ohio State",
        position: "WR",
        id: "player3"
    },
    {
        name: "Olumuyiwa Fashanu",
        school: "Penn State",
        position: "OT",
        id: "player4"
    },
    {
        name: "Brock Bowers",
        school: "Georgia",
        position: "TE",
        id: "player5"
    },
    {
        name: "Laiatu Latu",
        school: "UCLA",
        position: "EDGE",
        id: "player6"
    },
    {
        name: "Joe Alt",
        school: "Notre Dame",
        position: "OT",
        id: "player7"
    },
    {
        name: "Malik Nabers",
        school: "LSU",
        position: "WR",
        id: "player8"
    },
    {
        name: "Jer'Zhan Newton",
        school: "Illinois",
        position: "IDL",
        id: "player9"
    },
    {
        name: "Rome Odunze",
        school: "Washington",
        position: "WR",
        id: "player10"
    },
    {
        name: "Chop Robinson",
        school: "Penn State",
        position: "EDGE",
        id: "player11"
    },
    {
        name: "Kool-Aid McKinstry",
        school: "Alabama",
        position: "CB",
        id: "player12"
    },
    {
        name: "Jared Verse",
        school: "FSU",
        position: "EDGE",
        id: "player13"
    },
    {
        name: "Nate Wiggins",
        school: "Clemson",
        position: "CB",
        id: "player14"
    },
    {
        name: "Dallas Turner",
        school: "Alabama",
        position: "EDGE",
        id: "player15"
    },
    {
        name: "Taliese Fuaga",
        school: "Oregon State",
        position: "OT",
        id: "player16"
    },
    {
        name: "Bo Nix",
        school: "Oregon",
        position: "QB",
        id: "player17"
    },
    {
        name: "Bralen Trice",
        school: "Washington",
        position: "EDGE",
        id: "player18"
    },
    {
        name: "JC Latham",
        school: "Alabama",
        position: "OT",
        id: "player19"
    },
    {
        name: "Cooper DeJean",
        school: "Iowa",
        position: "CB",
        id: "player20"
    },
    {
        name: "Keon Coleman",
        school: "FSU",
        position: "WR",
        id: "player21"
    },
    {
        name: "Jayden Daniels",
        school: "LSU",
        position: "QB",
        id: "player22"
    },
    {
        name: "Emeka Egbuka",
        school: "Ohio State",
        position: "WR",
        id: "player23"
    },
    {
        name: "Kamren Kinchens",
        school: "Miami",
        position: "S",
        id: "player24"
    },
    {
        name: "Michael Penix Jr",
        school: "Washington",
        position: "QB",
        id: "player25"
    },
    {
        name: "Amarius Mims",
        school: "Georgia",
        position: "OT",
        id: "player26"
    },
    {
        name: "Tyler Nubin",
        school: "Minnesota",
        position: "S",
        id: "player27"
    },
    {
        name: "Graham Barton",
        school: "Duke",
        position: "OT",
        id: "player28"
    },
    {
        name: "Adonai Mitchell",
        school: "Texas",
        position: "WR",
        id: "player29"
    },
    {
        name: "Leonard Taylor III",
        school: "Miami",
        position: "IDL",
        id: "player30"
    },
    {
        name: "Kalen King",
        school: "Penn State",
        position: "CB",
        id: "player31"
    },
    {
        name: "Xavier Legette",
        school: "South Carolina",
        position: "WR",
        id: "player32"
    },

];

let teams = [
    {
        name: "Chicago Bears",
        pick: 1,
        id: "bears1"
    },
    {
        name: "Arizona Cardinals",
        pick: 2,
        id: "cardinals1"
    },
    {
        name: "New England Patriots",
        pick: 3,
        id: "patriots1"
    },
    {
        name: "Chicago Bears",
        pick: 4,
        id: "bears2"
    },
    {
        name: "Washington Commanders",
        pick: 5,
        id: "commanders1"
    },
    {
        name: "New York Giants",
        pick: 6,
        id: "giants1"
    },
    {
        name: "Tampa Bay Buccaneers",
        pick: 7,
        id: "buccaneers1"
    },
    {
        name: "New York Jets",
        pick: 8,
        id: "jets1"
    },
    {
        name: "Los Angeles Chargers",
        pick: 9,
        id: "chargers1"
    },
    {
        name: "Tennessee Titans",
        pick: 10,
        id: "titans1"
    },
    {
        name: "Las Vegas Raiders",
        pick: 11,
        id: "raiders1"
    },
    {
        name: "New Orleans Saints",
        pick: 12,
        id: "saints1"
    },
    {
        name: "Green Bay Packers",
        pick: 13,
        id: "packers1"
    },
    {
        name: "Los Angeles Rams",
        pick: 14,
        id: "rams1"
    },
    {
        name: "Cincinnati Bengals",
        pick: 15,
        id: "bengals1"
    },
    {
        name: "Buffalo Bills",
        pick: 16,
        id: "bills1"
    },
    {
        name: "Arizona Cardinals",
        pick: 17,
        id: "cardinals2"
    },
    {
        name: "Denver Broncos",
        pick: 18,
        id: "broncos1"
    },
    {
        name: "Atlanta Falcons",
        pick: 19,
        id: "falcons1"
    },
    {
        name: "Minnesota Vikings",
        pick: 20,
        id: "vikings1"
    },
    {
        name: "Indianapolis Colts",
        pick: 21,
        id: "colts1"
    },
    {
        name: "Seattle Seahawks",
        pick: 22,
        id: "seahawks1"
    },
    {
        name: "Pittsburgh Steelers",
        pick: 23,
        id: "steelers1"
    },
    {
        name: "Houston Texans",
        pick: 24,
        id: "texans1"
    },
    {
        name: "Miami Dolphins",
        pick: 25,
        id: "dolphins1"
    },
    {
        name: "Dallas Cowboys",
        pick: 26,
        id: "cowboys1"
    },
    {
        name: "Detroit Lions",
        pick: 27,
        id: "lions1"
    },
    {
        name: "Jacksonville Jaguars",
        pick: 28,
        id: "jaguars1"
    },
    {
        name: "Kansas City Chiefs",
        pick: 29,
        id: "chiefs1"
    },
    {
        name: "San Francisco 49ers",
        pick: 30,
        id: "49ers1"
    },
    {
        name: "Baltimore Ravens",
        pick: 31,
        id: "ravens1"
    },
    {
        name: "Philadelphia Eagles",
        pick: 32,
        id: "eagles1"
    },

];

let finalPicks = [
    {
        name: "Tampa Bay Buccaneers",
        pick: 1,
        id: "buccaneers1",
        player: "Caleb Williams"
    },
    {
        name: "Arizona Cardinals",
        pick: 2,
        id: "cardinals1",
        player: "Marvin Harrison Jr"
    },
    {
        name: "New England Patriots",
        pick: 3,
        id: "patriots1",
        player: "Drake Maye"
    },
    {
        name: "Chicago Bears",
        pick: 4,
        id: "bears2",
        player: "Olumuyiwa Fashanu"
    },
    {
        name: "Washington Commanders",
        pick: 5,
        id: "commanders1",
        player: "Joe Alt"
    },
    {
        name: "New York Jets",
        pick: 6,
        id: "jets1",
        player: "Brock Bowers"
    },
    {
        name: "Chicago Bears",
        pick: 7,
        id: "bears1",
        player: "Laiatu Latu"
    },
    {
        name: "New York Giants",
        pick: 8,
        id: "giants1",
        player: "Malik Nabers"
    },
    {
        name: "Los Angeles Chargers",
        pick: 9,
        id: "chargers1",
        player: "Jer'Zhan Newton"
    },
    {
        name: "Tennessee Titans",
        pick: 10,
        id: "titans1",
        player: "Chop Robinson"
    },
    {
        name: "Las Vegas Raiders",
        pick: 11,
        id: "raiders1",
        player: "Rome Odunze"
    },
    {
        name: "New Orleans Saints",
        pick: 12,
        id: "saints1",
        player: "Bo Nix"
    },
    {
        name: "Green Bay Packers",
        pick: 13,
        id: "packers1",
        player: "Kool-Aid McKinstry"
    },
    {
        name: "Los Angeles Rams",
        pick: 14,
        id: "rams1",
        player: "Jared Verse"
    },
    {
        name: "Cincinnati Bengals",
        pick: 15,
        id: "bengals1",
        player: "Taliese Fuaga"
    },
    {
        name: "Denver Broncos",
        pick: 16,
        id: "broncos1",
        player: "Nate Wiggins"
    },
    {
        name: "Arizona Cardinals",
        pick: 17,
        id: "cardinals2",
        player: "Dallas Turner"
    },
    {
        name: "Buffalo Bills",
        pick: 18,
        id: "bills1",
        player: "Bralen Trice"
    },
    {
        name: "Atlanta Falcons",
        pick: 19,
        id: "falcons1",
        player: "Jayden Daniels"
    },
    {
        name: "Minnesota Vikings",
        pick: 20,
        id: "vikings1",
        player: "JC Latham"
    },
    {
        name: "Indianapolis Colts",
        pick: 21,
        id: "colts1",
        player: "Cooper DeJean"
    },
    {
        name: "Seattle Seahawks",
        pick: 22,
        id: "seahawks1",
        player: "Kamren Kinchens"
    },
    {
        name: "Pittsburgh Steelers",
        pick: 23,
        id: "steelers1",
        player: "Keon Coleman"
    },
    {
        name: "Houston Texans",
        pick: 24,
        id: "texans1",
        player: "Emeka Egbuka"
    },
    {
        name: "Miami Dolphins",
        pick: 25,
        id: "dolphins1",
        player: "Tyler Nubin"
    },
    {
        name: "Dallas Cowboys",
        pick: 26,
        id: "cowboys1",
        player: "Amarius Mims"
    },
    {
        name: "Detroit Lions",
        pick: 27,
        id: "lions1",
        player: "Graham Barton"
    },
    {
        name: "San Francisco 49ers",
        pick: 28,
        id: "49ers1",
        player: "Michael Penix Jr"
    },
    {
        name: "Kansas City Chiefs",
        pick: 29,
        id: "chiefs1",
        player: "Adonai Mitchell"
    },
    {
        name: "Jacksonville Jaguars",
        pick: 30,
        id: "jaguars1",
        player: "Leonard Taylor III"
    },
    {
        name: "Baltimore Ravens",
        pick: 31,
        id: "ravens1",
        player: "Xavier Legette"
    },
    {
        name: "Philadelphia Eagles",
        pick: 32,
        id: "eagles1",
        player: "Kalen King"
    },

];

let currentTeam = null;

function initDragula() {
    dragula([document.querySelector('#dragParent')]);
}

document.addEventListener("DOMContentLoaded", function () {
    var dragThings = document.querySelectorAll('.dragThing');

    dragThings.forEach(function (dragThing) {
        dragThing.addEventListener('click', function () {
            switchTeam(dragThing);
        });
        dragThing.addEventListener('mousemove', changePickNumber);
        dragThing.addEventListener('touchend',changePickNumber);
    });
});

function switchTeam(clickedTeam) {
    // Remove the 'selected' class from all elements
    document.querySelectorAll('.dragThing').forEach(function (element) {
        element.classList.remove('selected');
    });

    // Add the 'selected' class to the clicked element
    clickedTeam.classList.add('selected');

    // Set the currentTeam to the clicked team
    currentTeam = clickedTeam.querySelector('.teamName').textContent.trim(); // The team name is the text content
    console.log("Current Team: " + currentTeam);
}

function selectPlayer(event) {
    if (currentTeam) {
        let selectedPlayerElement = event.target.closest('.players');

        if (selectedPlayerElement) {
            let playerName = selectedPlayerElement.querySelector('.playerName').textContent;
            let playerPosition = selectedPlayerElement.querySelector('.playerPosition').textContent;
            let playerSchool = selectedPlayerElement.querySelector('.playerSchool').textContent;

            // Create a new player element
            let newPlayerElement = document.createElement('div');
            newPlayerElement.className = 'selectedPlayer';

            let playerInfoElement = document.createElement('div');
            let playerImageElement = document.createElement('div');
            let playerNameElement = document.createElement('div');
            let playerSchoolElement = document.createElement('div');
            let playerPositionElement = document.createElement('div');
            playerInfoElement.className = 'playerInfo';
            playerImageElement.className = 'playerImage';
            playerNameElement.className = 'selectedPlayerName';
            playerPositionElement.className = 'selectedPlayerPosition';
            playerSchoolElement.className = 'selectedPlayerSchool';
            playerNameElement.appendChild(document.createTextNode(playerName));
            playerPositionElement.appendChild(document.createTextNode(playerPosition));
            playerSchoolElement.appendChild(document.createTextNode(playerSchool));
            playerInfoElement.appendChild(playerNameElement);
            playerInfoElement.appendChild(playerSchoolElement);
            playerInfoElement.appendChild(playerPositionElement);
            

            let rosterPhotoElement = selectedPlayerElement.querySelector('.rosterPhoto');
            
            if (rosterPhotoElement) {
                playerImageElement.appendChild(rosterPhotoElement.cloneNode(true));
            } else {
                console.error("Error: Unable to find '.rosterPhoto' element.");
            }

            selectedPlayerElement.remove();

            newPlayerElement.appendChild(playerInfoElement);
            newPlayerElement.appendChild(playerImageElement);

            // Append the new player element to the selected team
            let selectedTeam = document.querySelector('.selected');
            selectedTeam.appendChild(newPlayerElement);

            // Remove the selected player from the availablePlayers div
            let availablePlayers = document.querySelector('.availablePlayers');
            let selectedPlayer = document.querySelector('.selected');

            console.log("The " + currentTeam + " have selected " + playerName + "!");
        } else {
            console.error("Error: Unable to find selected player element.");
        }
    } else {
        alert("Please select a team first.");
    }
}




function addTeam() {
    let dragParent = document.querySelector('#dragParent');

    for (let i =0; i<teams.length; i++){
    let newTeam = document.createElement('div');
    newTeam.className = 'dragThing';
    newTeam.id = teams[i].id;

    let teamAndPickElement = document.createElement('div');
    let teamNameElement = document.createElement('div');
    let pickElement = document.createElement('div');
    teamNameElement.className = 'teamName';
    pickElement.className = 'pick';
    teamAndPickElement.className = 'teamAndPick';

    teamNameElement.textContent = teams[i].name;
    pickElement.textContent = teams[i].pick + ".";

    teamAndPickElement.appendChild(pickElement);
    teamAndPickElement.appendChild(teamNameElement);
    newTeam.appendChild(teamAndPickElement);
    

    dragParent.appendChild(newTeam);
}
}

function addPlayer(){
    let availablePlayers = document.querySelector('.availablePlayers');
    availablePlayers.className = 'availablePlayers';

    for (let i=0; i<players.length; i++){
        let newPlayer = document.createElement('div');
    newPlayer.className = 'players';
    newPlayer.id = players[i].id;

    let playerNameElement = document.createElement('div');
    let schoolElement = document.createElement('div');
    let positionElement = document.createElement('div');
    let playerPhotoElement = document.createElement('div'); 
    let rosterPhotoElement = document.createElement('img');
    rosterPhotoElement.src = "Assets/" + players[i].name + ".png";
    let addButton = document.createElement('img');
    addButton.src = "Assets/Icon Plus.png";
    

    playerNameElement.className = 'playerName';
    schoolElement.className = 'playerSchool';
    positionElement.className = 'playerPosition';
    rosterPhotoElement.className = 'rosterPhoto';
    addButton.className = 'addPlayerButton';

    playerNameElement.textContent = players[i].name;
    schoolElement.textContent = players[i].school;
    positionElement.textContent = players[i].position;

    playerPhotoElement.appendChild(rosterPhotoElement);
    newPlayer.appendChild(addButton);
    newPlayer.appendChild(playerPhotoElement);
    newPlayer.appendChild(playerNameElement);
    newPlayer.appendChild(schoolElement);
    newPlayer.appendChild(positionElement);
   

    availablePlayers.appendChild(newPlayer);  

    }
}

addPlayer();
addTeam();


let addPlayerButtons = document.querySelectorAll(".addPlayerButton");
addPlayerButtons.forEach( (addPlayerButton) => {
    addPlayerButton.addEventListener("click", selectPlayer);
})


function scoreTeam (){
    let teamScore = 0;
    for (let i=0; i<finalPicks.length; i++){
        let teamID = document.getElementById(finalPicks[i].id);
        let parent = teamID.parentNode;
        let teamIndex = Array.prototype.indexOf.call(parent.children, teamID);
        if ((teamIndex + 1 === finalPicks[i].pick)){
            teamScore = teamScore + 1;
            teamID.style.color = 'green';
        }
        else{
            teamID.style.color = 'red';
        }
    }
    console.log("Team Score: " + teamScore);
    return teamScore;
}

function scorePlayers() {
    let playerScore = 0;

    let dragThings = document.querySelectorAll('.dragThing');

    dragThings.forEach(function (dragThing) {
        let teamName = dragThing.querySelector('.teamName').textContent.trim();

        // Access player information within the dragThing
        let selectedPlayer = dragThing.querySelector('.selectedPlayer');
        if (selectedPlayer) {
            let playerName = selectedPlayer.querySelector('.selectedPlayerName').textContent.trim();

            // Check if the playerName matches with the same team in finalPicks
            let matchingPick = finalPicks.find(pick => pick.name === teamName && pick.player === playerName);

            if (matchingPick) {
                playerScore += 1;
                console.log("Match found for Team: " + teamName + ", Player: " + playerName);
                selectedPlayer.style.color = 'green';
            } else {
                console.log("No match found for Team: " + teamName + ", Player: " + playerName);
                selectedPlayer.style.color = 'red';
            }
        } else {
            console.log("No selected player for Team: " + teamName);
        }
    });

    console.log("Player Score: " + playerScore);
    return playerScore;
}

//let totalScore = 0;

function calculateTotalScore() {
    let score = 0;
    score = scoreTeam() + scorePlayers();
    console.log("Total Score: " + score);
    return score;
}

function updateScoreboard(){
    calculateTotalScore();
    
    let submissionBox = document.getElementById('submissionBox');
    let totalScoreElement = document.createElement('div');
    totalScoreElement.textContent = "Total Score: " + calculateTotalScore();
    console.log(calculateTotalScore());
    alert(totalScoreElement.textContent);

    totalScoreElement.className = 'totalScore';
    submissionBox.appendChild(totalScoreElement);

}







let submitButton = document.querySelector('.submitButton');
submitButton.addEventListener('click',updateScoreboard);

function changePickNumber() {
    let teams = document.querySelectorAll('.dragThing');

    for (let i = 0; i < teams.length; i++) {
        let team = teams[i];
        let pickClass = team.querySelector(".pick");
        let pickNumber = i + 1;
        pickClass.textContent = pickNumber + ".";
    }
}

let informationIcon = document.querySelector('#informationIcon');
let howToPlay = document.querySelector('#howToPlayText');

informationIcon.addEventListener('click',instructionPage);
howToPlay.addEventListener('click',instructionPage);


function instructionPage (){
    location.href = './instructions.html';
}


